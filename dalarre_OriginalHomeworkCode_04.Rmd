---
title: "dalarre_OriginalHomeworkCode_04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.



## HOMEWORK 4

##Write a simple R function, Z.prop.test(), that can perform one- or two-sample Z-tests for proportion data

```{r}

z.prop.test <- function(p1, n1, p2 = NULL, n2 = NULL, p0, alternative = "two.sided", conf.level = 0.95) {

  ## For 1 sample
  if (is.null(p2) == TRUE || is.null(n2) == TRUE) {
    
    z <- (p1 - p0)/sqrt(p0 * (1 - p0)/n1)
    
    if(n1*p1 < 5 || n1*(1-p1) < 5) {
      print("Your sample does not follow the rules of thumb (n∗p>5 and n∗(1−p)>5")
    }
    
    if (alternative == "less") {
      p <- pnorm(z, lower.tail = TRUE)
      
      lower <- p1 - qnorm(1-(1-conf.level)/2) * sqrt(p1 * (1 - p1)/n1)
      upper <- p1 + qnorm(1-(1-conf.level)/2) * sqrt(p1 * (1 - p1)/n1)
      ci <- c(lower, upper)
      
    }
    
    if (alternative == "greater") {
      p <- pnorm(z, lower.tail = FALSE)
      
        }
    
    if (alternative == "two.sided") {
      
      if (z > 0) {
        p <- 2 * pnorm(z, lower.tail = FALSE)
      }  
      
      if (z < 0)
                {
        p <- 2 * pnorm(z, lower.tail = TRUE)
                } 
      
    }
  }
 
  return(c(z,p))
}

```

